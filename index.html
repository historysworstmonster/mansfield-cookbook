<script>
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxV8_dX5ejMfHFkvqS2S8VdFMDWtx-dXPuCQJbq3AFalqMcwerpU1eKd_CZoR3gN6Ra/exec";
    let allRecipes = []; 

    window.onload = function() {
        loadData("RSVPs", "dishTable");
        loadData("Suggestions", "suggestionList");
        loadData("Recommendations", "recList");
        loadArchive(); 
    };

    async function loadArchive() {
        if (WEB_APP_URL.includes("PASTE_YOUR_NEW_URL")) return;
        try {
            console.log("Attempting to load Archive...");
            const response = await fetch(`${WEB_APP_URL}?sheet=Archive`);
            allRecipes = await response.json();
            console.log("Archive data received:", allRecipes);
            displayRecipes(allRecipes);
        } catch (e) {
            console.error("Archive Error:", e);
        }
    }

    function displayRecipes(data) {
        const grid = document.getElementById('recipeGrid');
        if (!grid) return;
        grid.innerHTML = ""; // Clear the "Loading" text
        
        if (data.length === 0) {
            grid.innerHTML = "No recipes found.";
            return;
        }

        data.forEach(row => {
            grid.innerHTML += `
                <div class="recipe-card">
                    <h3>${row[0]}</h3>
                    <p>Source: ${row[1] || 'Club Archive'}</p>
                    <a href="${row[2]}" target="_blank" class="view-btn">ðŸ“„ View PDF</a>
                    <button class="delete-btn" style="float:right" onclick="deleteEntry('Archive', '${row[0]}', 'recipeGrid')">Ã—</button>
                </div>`;
        });
    }

    function filterRecipes() {
        const term = document.getElementById('recipeSearch').value.toLowerCase();
        const filtered = allRecipes.filter(r => 
            (r[0] && r[0].toLowerCase().includes(term)) || 
            (r[1] && r[1].toLowerCase().includes(term))
        );
        displayRecipes(filtered);
    }

    // ... (Keep your loadData, deleteEntry, handleVote, and sendToSheet functions here) ...
</script>
